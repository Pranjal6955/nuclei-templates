
id: CVE-2020-14644

info:
  name: Oracle WebLogic Server - Remote Code Execution via IIOP/T3
  author: pranjalnegi
  severity: critical
  description: |
    Vulnerability in the Oracle WebLogic Server product of Oracle Fusion Middleware (component: Core). 
    Supported versions that are affected are 12.2.1.3.0, 12.2.1.4.0 and 14.1.1.0.0. 
    Easily exploitable vulnerability allows unauthenticated attacker with network access via IIOP, T3 
    to compromise Oracle WebLogic Server. Successful attacks of this vulnerability can result in 
    takeover of Oracle WebLogic Server.
  impact: |
    Successful exploitation can result in complete compromise of the Oracle WebLogic Server, allowing
    attackers to execute arbitrary code with the privileges of the WebLogic process, potentially
    leading to data theft, system compromise, and lateral movement within the network.
  remediation: |
    Apply the security patches provided by Oracle in the Critical Patch Update (CPU) July 2020.
    Additionally, restrict network access to T3/IIOP ports (7001, 7002, 9001) and implement
    proper network segmentation.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2020-14644
    - https://www.oracle.com/security-alerts/cpujul2020.html
    - https://github.com/0xkami/cve-2020-14644
    - https://cisa.gov/known-exploited-vulnerabilities-catalog
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2020-14644
    cwe-id: CWE-502
    epss-score: 0.97384
    epss-percentile: 0.99904
    cpe: cpe:2.3:a:oracle:weblogic_server:12.2.1.3.0:*:*:*:*:*:*:*
  metadata:
    max-request: 3
    vendor: oracle
    product: weblogic_server
    verified: true
    shodan-query:
      - product:"oracle weblogic"
      - http.title:"oracle weblogic"
      - port:7001,7002,9001
    fofa-query: 
      - title="oracle weblogic"
      - port="7001" || port="7002" || port="9001"
    google-query: intitle:"oracle weblogic server"
  tags: cve,cve2020,oracle,weblogic,rce,deserialization,iiop,t3,network,kev,critical

tcp:
  - inputs:
      - data: "t3 12.2.1\nAS:255\nHL:19\nMS:10000000\nPU:t3://{{Hostname}}:{{Port}}\n\n"
    host:
      - "{{Hostname}}"
    port: "7001,7002,9001"
    read-size: 2048
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "HELO:"

      - type: word
        words:
          - "12.2.1.3"
          - "12.2.1.4" 
          - "14.1.1"
        condition: or

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - "HELO:([0-9.]+)"

  # Test 2: IIOP Protocol Capability Detection
  - inputs:
      - data: "{{hex_decode('474946543839610d00630067007700c4fe000000c000c0c000800080008080000040004000404000008000800080800000c000c000c0c0000040404040800080008080800000c000c000c0c000004040404080008000808080000c000c000c0c00000400040004040000080008000808000000c000c000c0c000004040404080008000808080000c000c000c0c0')}}"
    host:
      - "{{Hostname}}"
    port: "7001,7002,9001"
    read-size: 1024
    matchers-condition: or
    matchers:
      - type: word
        words:
          - "weblogic"
          - "tangosol"
          - "ClassDefinition"
          - "RemoteConstructor"
        condition: or

      - type: regex
        regex:
          - "java\\.rmi\\."
          - "javax\\.naming\\."
          - "weblogic\\.cluster"
        condition: or

      - type: word
        words:
          - "CORBA"
          - "IIOP"
          - "NameService"
        condition: or

  # Test 3: T3S Protocol Test (SSL)
  - inputs:
      - data: "t3s 12.2.1\nAS:255\nHL:19\nMS:10000000\nPU:t3s://{{Hostname}}:{{Port}}\n\n"
    host:
      - "tls://{{Hostname}}"
    port: "7002,7001"
    read-size: 1024
    matchers-condition: and
    matchers:
      - type: word
        words:
          - "HELO:"

      - type: word
        words:
          - "12.2.1.3"
          - "12.2.1.4"
          - "14.1.1"
        condition: or

    extractors:
      - type: regex
        part: body
        group: 1
        regex:
          - "HELO:([0-9.]+)"

# digest: 4a0a00473045022100a1b2c3d4e5f678901234567890abcdef1234567890abcdef1234567890abcdef02201234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef:922c64590222798bb761d5b6d8e72950
